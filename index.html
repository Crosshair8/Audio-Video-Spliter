<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Audio/Video Splitter + Transcribe</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #0f0f0f;
        color: #fff;
        padding: 20px;
      }
      h1 { margin-top: 0; }
      .box {
        border: 1px solid #333;
        border-radius: 10px;
        padding: 14px;
        margin-bottom: 14px;
        background: #151515;
      }
      label {
        display: block;
        margin: 8px 0 4px;
      }
      input, select, button {
        padding: 10px;
        margin-top: 6px;
        border-radius: 8px;
        border: 1px solid #333;
        background: #0f0f0f;
        color: #fff;
        width: 100%;
        box-sizing: border-box;
      }
      button {
        cursor: pointer;
        font-weight: 700;
      }
      button:disabled { opacity: 0.6; cursor: not-allowed; }

      #links a, #proLinks a {
        display: block;
        margin: 6px 0;
        color: #6cb6ff;
        text-decoration: none;
      }
      #links a:hover, #proLinks a:hover { text-decoration: underline; }

      #detectedType {
        margin-top: 8px;
        opacity: 0.9;
      }
      #log {
        white-space: pre-wrap;
        background: #0b0b0b;
        border: 1px solid #333;
        border-radius: 10px;
        padding: 12px;
        max-height: 260px;
        overflow: auto;
        font-family: Consolas, monospace;
        font-size: 13px;
      }
      .small {
        opacity: 0.8;
        font-size: 13px;
        margin-top: 6px;
      }
      .row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      @media(max-width: 800px){
        .row { grid-template-columns: 1fr; }
      }

      /* ✅ AI PRO layout */
      .proRow {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 12px;
        align-items: start;
        margin-top: 8px;
      }
      @media(max-width: 900px){
        .proRow { grid-template-columns: 1fr; }
      }

      #proLinks {
        border: 1px solid #333;
        border-radius: 10px;
        padding: 10px;
        background: #0f0f0f;
      }
    </style>
  </head>

  <body>
    <h1>Audio / Video Splitter + Transcribe</h1>

    <div class="box">
      <label>Upload audio or video</label>
      <input id="file" type="file" accept="audio/*,video/*" />
      <div id="detectedType">No file selected</div>
      <div class="small">
        ✅ Audio = can transcribe. ✅ Video = split only (auto OFF).
      </div>
    </div>

    <div class="box">
      <div class="row">
        <div>
          <label>Split length</label>
          <select id="splitSize">
            <option value="300">5 minutes</option>
            <option value="600">10 minutes</option>
            <option value="1200">20 minutes</option>
            <option value="1800">30 minutes</option>
            <option value="custom">Custom</option>
          </select>

          <label id="customLabel" style="display:none;">Custom seconds</label>
          <input
            id="customSeconds"
            style="display:none;"
            type="number"
            min="1"
            value="300"
          />
        </div>

        <div>
          <label>Mode</label>
          <select id="transcribeMode">
            <option value="off" selected>OFF (Split only)</option>
            <option value="simple">SIMPLE (Local)</option>
            <option value="best">SIMPLE + SPEAKERS (BETA)</option>
            <option value="pro">AI PRO (OpenAI Diarization)</option>
          </select>

          <div class="small">
            If you upload a VIDEO, this will automatically lock to OFF.
          </div>
        </div>
      </div>
    </div>

    <!-- ✅ ONE QUALITY DROPDOWN ONLY -->
    <div class="box" id="qualityBox">
      <div style="font-weight:700; margin-bottom:8px;">Quality / Speed</div>

      <label id="qualityLabel">Setting</label>
      <select id="qualitySelect"></select>

      <div class="small" id="qualityHint">
        Higher quality can take longer and create bigger files.
      </div>
    </div>

    <!-- ✅ AI PRO settings -->
    <div class="box" id="proBox" style="display:none;">
      <div style="font-weight:700;">AI PRO Settings</div>

      <!-- ✅ KEY + LINKS SIDE BY SIDE -->
      <div class="proRow">
        <div>
          <label>OpenAI API Key (sk-...)</label>
          <input id="apiKey" type="password" placeholder="sk-..." />

          <label style="display:flex; gap:10px; align-items:center; margin-top:10px;">
            <input id="rememberKey" type="checkbox" style="width:auto;" />
            Remember key on this device
          </label>

          <button id="clearKey" type="button" style="margin-top:8px;">
            Clear saved key
          </button>
        </div>

        <!-- ✅ SHOWS IMMEDIATELY WHEN YOU PICK AI PRO -->
        <div>
          <div style="font-weight:700; margin-bottom:6px;">OpenAI Setup</div>
          <div id="proLinks"></div>
        </div>
      </div>

      <div class="small" style="margin-top:10px;">
        Your key is stored only in your browser storage if “Remember” is enabled.
      </div>
    </div>

    <div class="box">
      <button id="start">Start</button>

      <button id="zipBtn" style="display:none; margin-top:10px;">
        Download all as ZIP
      </button>

      <label style="margin-top:12px;">Progress</label>
      <progress id="progress" value="0" max="1" style="width:100%; height:18px;"></progress>

      <div id="status" style="margin-top:10px;"></div>
      <div id="links" style="margin-top:12px;"></div>
    </div>

    <div class="box">
      <div style="font-weight:700; margin-bottom:8px;">Log</div>
      <div id="log"></div>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
